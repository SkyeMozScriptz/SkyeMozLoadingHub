-- SkyeMoz Intro v5 â€“ Full Fade Out & Animation Fix ðŸ”¥

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")
local UserInputService = game:GetService("UserInputService")

-- Create GUI
local gui = Instance.new("ScreenGui")
gui.Name = "SkyeMozIntro"
gui.IgnoreGuiInset = true
gui.ResetOnSpawn = false
if syn and syn.protect_gui then
	syn.protect_gui(gui)
	gui.Parent = CoreGui
elseif gethui then
	gui.Parent = gethui()
elseif protect_gui then
	protect_gui(gui)
	gui.Parent = CoreGui
else
	gui.Parent = CoreGui
end

-- Background
local bg = Instance.new("Frame", gui)
bg.Size = UDim2.new(1,0,1,0)
bg.BackgroundColor3 = Color3.new(0,0,0)
bg.BackgroundTransparency = 1

-- Title
local title = Instance.new("TextLabel", bg)
title.Size = UDim2.new(1,0,0.2,0)
title.Position = UDim2.new(0,0,0.3,0)
title.Text = "SkyeMoz | Hub ðŸ”¥"
title.Font = Enum.Font.FredokaOne
title.TextSize = 48
title.TextColor3 = Color3.new(1,1,1)
title.BackgroundTransparency = 1
title.TextTransparency = 1

-- Loading text
local loadingText = Instance.new("TextLabel", bg)
loadingText.Size = UDim2.new(1,0,0.05,0)
loadingText.Position = UDim2.new(0,0,0.5,0)
loadingText.Font = Enum.Font.SourceSans
loadingText.TextSize = 26
loadingText.TextColor3 = Color3.new(1,1,1)
loadingText.BackgroundTransparency = 1
loadingText.Text = "Loading parts: 0"
loadingText.TextTransparency = 1

-- Loading bar background
local barBG = Instance.new("Frame", bg)
barBG.Size = UDim2.new(0.6,0,0.025,0)
barBG.Position = UDim2.new(0.2,0,0.58,0)
barBG.BackgroundColor3 = Color3.fromRGB(50,50,50)
barBG.BackgroundTransparency = 0.3
Instance.new("UICorner", barBG).CornerRadius = UDim.new(0, 10)

-- Loading bar fill
local barFill = Instance.new("Frame", barBG)
barFill.Size = UDim2.new(0,0,1,0)
barFill.BackgroundColor3 = Color3.fromRGB(255,165,0)
Instance.new("UICorner", barFill).CornerRadius = UDim.new(0, 10)

-- Skip button
local skipBtn = Instance.new("TextButton", bg)
skipBtn.Text = "Skip â©"
skipBtn.Font = Enum.Font.SourceSansBold
skipBtn.TextSize = 22
skipBtn.Size = UDim2.new(0,100,0,40)
skipBtn.Position = UDim2.new(0.95,0,0.93,0)
skipBtn.AnchorPoint = Vector2.new(1,1)
skipBtn.BackgroundColor3 = Color3.new(0,0,0)
skipBtn.BackgroundTransparency = 0.5
skipBtn.TextColor3 = Color3.new(1,1,1)
skipBtn.Visible = false

-- Sound
local sound = Instance.new("Sound", bg)
sound.SoundId = "5621616510"
sound.Volume = 1

-- State
local skipEnabled = false
local introComplete = false
local alreadyFading = false

-- Fade helper
local function fade(obj, prop, from, to, time)
	obj[prop] = from
	TweenService:Create(obj, TweenInfo.new(time, Enum.EasingStyle.Quad), {[prop] = to}):Play()
end

-- Fade in intro
fade(bg, "BackgroundTransparency", 1, 0, 1)
sound:Play()
delay(1, function()
	TweenService:Create(title, TweenInfo.new(0.8, Enum.EasingStyle.Back), {
		TextTransparency = 0,
		Position = UDim2.new(0,0,0.25,0)
	}):Play()
end)

-- Random loading
local loadTime = math.random(10, 30)
local partGoal = math.random(8888, 92829283)

delay(2, function()
	fade(loadingText, "TextTransparency", 1, 0, 0.5)
	local startTime = tick()
	local con
	con = RunService.RenderStepped:Connect(function()
		if introComplete then return end
		local t = (tick() - startTime) / loadTime
		local eased = math.clamp(math.sin(t * math.pi / 2), 0, 1)
		local parts = math.floor(eased * partGoal)
		loadingText.Text = "Loading parts: " .. parts
		barFill.Size = UDim2.new(eased, 0, 1, 0)
		if t >= 1 then
			introComplete = true
			con:Disconnect()
		end
	end)
end)

-- Enable skip after 5s
delay(5, function()
	skipEnabled = true
	skipBtn.Visible = true
end)

-- Final fade out
local function doFadeOut()
	if alreadyFading then return end
	alreadyFading = true
	TweenService:Create(bg, TweenInfo.new(1), {BackgroundTransparency = 1}):Play()
	TweenService:Create(title, TweenInfo.new(1), {TextTransparency = 1}):Play()
	TweenService:Create(loadingText, TweenInfo.new(1), {TextTransparency = 1}):Play()
	TweenService:Create(barBG, TweenInfo.new(1), {BackgroundTransparency = 1}):Play()
	TweenService:Create(barFill, TweenInfo.new(1), {
		Size = UDim2.new(0,0,1,0),
		BackgroundTransparency = 1
	}):Play()
	TweenService:Create(skipBtn, TweenInfo.new(0.5), {TextTransparency = 1}):Play()
	wait(1.2)
	gui:Destroy()
end

-- Bind skip button
skipBtn.MouseButton1Click:Connect(function()
	if skipEnabled then doFadeOut() end
end)

-- Tap anywhere to skip
bg.InputBegan:Connect(function(input)
	if skipEnabled and (input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1) then
		doFadeOut()
	end
end)

-- Auto fade out when loading done
RunService.RenderStepped:Connect(function()
	if introComplete and skipEnabled then
		doFadeOut()
	end
end)
